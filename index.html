<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>JapaneseGO</title>
    <style>
        :root {
            --bg-color: #000000;
            --card-bg: rgba(28, 28, 30, 0.65);
            --glass-border: rgba(255, 255, 255, 0.12);
            --accent-color: #0A84FF;
            --success-color: #30D158;
            --text-primary: #FFFFFF;
            --text-secondary: #8E8E93;
            --text-romaji: #FFD60A;
            --danger: #FF453A;
        }

        body {
            background: linear-gradient(135deg, #1c1c1e 0%, #000000 100%);
            background-attachment: fixed;
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
            padding-bottom: 90px;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--glass-border);
            display: flex;
            justify-content: space-around;
            padding: 10px 0 25px 0; /* Extra padding for iPhone home bar */
            z-index: 200;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 10px;
            color: var(--text-secondary);
            cursor: pointer;
            width: 50%;
        }

        .nav-item.active {
            color: var(--accent-color);
        }

        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
        }

        /* Header */
        header {
            padding: 40px 20px 10px;
            background: rgba(0, 0, 0, 0.8);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--glass-border);
        }

        h1 {
            margin: 0;
            font-size: 28px;
            background: linear-gradient(90deg, #fff, #8E8E93);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Views */
        .view {
            display: none;
            padding: 10px 20px;
            max-width: 600px;
            margin: 0 auto;
            animation: fadeIn 0.3s ease;
        }

        .view.active-view {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- Dictionary Styles --- */
        .tabs {
            display: flex;
            overflow-x: auto;
            padding: 10px 0;
            gap: 10px;
            scrollbar-width: none;
        }
        .tabs::-webkit-scrollbar { display: none; }

        .tab {
            padding: 6px 14px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 18px;
            font-size: 13px;
            white-space: nowrap;
            color: var(--text-secondary);
            cursor: pointer;
        }
        .tab.active {
            background: var(--accent-color);
            color: white;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 18px;
            margin-bottom: 14px;
            position: relative;
            cursor: pointer;
        }
        .card:active { transform: scale(0.98); background: #333; }
        .card-header { display: flex; justify-content: space-between; margin-bottom: 6px; }
        .jp-text { font-size: 20px; font-weight: 700; line-height: 1.3; }
        .romaji { font-family: 'Courier New', monospace; color: var(--text-romaji); font-size: 14px; font-weight: 600; margin-bottom: 10px; display: block; }
        .cn-text { font-size: 16px; color: var(--text-primary); }
        .en-text { font-size: 12px; color: var(--text-secondary); margin-top: 2px; }
        .card.emergency { border: 1px solid rgba(255, 69, 58, 0.5); background: rgba(60, 20, 20, 0.6); }

        /* --- Curriculum Styles --- */
        .progress-container {
            margin-bottom: 20px;
            background: #1c1c1e;
            padding: 15px;
            border-radius: 16px;
            border: 1px solid var(--glass-border);
        }
        .progress-header {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }
        .progress-bar-bg {
            height: 8px;
            background: #333;
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-bar-fill {
            height: 100%;
            background: var(--success-color);
            width: 0%;
            transition: width 0.5s ease;
        }

        .week-block {
            margin-bottom: 25px;
        }
        .week-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--accent-color);
            display: flex;
            align-items: center;
        }
        .week-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
            margin-left: 10px;
            font-weight: 400;
        }

        .lesson-item {
            background: var(--card-bg);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .lesson-content {
            flex-grow: 1;
        }
        .lesson-jp { font-weight: 600; font-size: 16px; margin-bottom: 2px; }
        .lesson-cn { font-size: 13px; color: #ccc; }

        .checkbox-wrapper {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid var(--text-secondary);
            margin-left: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .checkbox-wrapper.checked {
            background: var(--success-color);
            border-color: var(--success-color);
        }
        .check-icon {
            color: white;
            font-size: 14px;
            display: none;
        }
        .checkbox-wrapper.checked .check-icon { display: block; }
        
        .play-btn {
            font-size: 18px;
            padding: 5px 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            margin-right: 10px;
            cursor: pointer;
        }

        /* Toast */
        #toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(30,30,30,0.95);
            padding: 10px 20px;
            border-radius: 20px;
            color: white;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            border: 1px solid #444;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 300;
        }
        #toast.show { opacity: 1; }

    </style>
</head>
<body>

<header>
    <h1>JapaneseGO</h1>
    <div style="font-size: 13px; color: #888;">Ê≤ñÁπ©ÁâπË®ì V2.0</div>
</header>

<div id="view-learn" class="view active-view">
    <div class="progress-container">
        <div class="progress-header">
            <span>Â≠∏ÁøíÈÄ≤Â∫¶ (Learning Progress)</span>
            <span id="progress-text">0%</span>
        </div>
        <div class="progress-bar-bg">
            <div class="progress-bar-fill" id="progress-fill"></div>
        </div>
        <div style="margin-top:8px; font-size:12px; color:#666;">ÊØèÂ§©Ëä± 10 ÂàÜÈêòÔºåÁÇ∫‰∫ÜÊòéÂπ¥3ÊúàÁöÑÊóÖË°åÔºÅ</div>
    </div>

    <div id="curriculum-container">
        </div>
    
    <div style="height: 50px;"></div> </div>

<div id="view-dict" class="view">
    <div class="tabs">
        <div class="tab active" onclick="filterDict('all', this)">ÂÖ®ÈÉ®</div>
        <div class="tab" onclick="filterDict('survival', this)">ÁîüÂ≠ò</div>
        <div class="tab" onclick="filterDict('dining', this)">ÁæéÈ£ü</div>
        <div class="tab" onclick="filterDict('shopping', this)">Ë≥ºÁâ©</div>
        <div class="tab" onclick="filterDict('kids', this)">Ë¶™Â≠ê</div>
        <div class="tab" onclick="filterDict('driving', this)">Ëá™Èßï</div>
        <div class="tab" onclick="filterDict('hotel', this)">‰ΩèÂÆø</div>
        <div class="tab" onclick="filterDict('emergency', this)">Á∑äÊÄ•</div>
    </div>
    <div id="dict-container" style="margin-top: 15px;">
        </div>
</div>

<div id="toast">üîä ÁôºÈü≥Êí≠Êîæ‰∏≠...</div>

<div class="bottom-nav">
    <div class="nav-item active" onclick="switchView('learn', this)">
        <div class="nav-icon">üìÖ</div>
        <div>ÁâπË®ìË®àÁï´</div>
    </div>
    <div class="nav-item" onclick="switchView('dict', this)">
        <div class="nav-icon">üìñ</div>
        <div>ÂØ¶Áî®Â≠óÂÖ∏</div>
    </div>
</div>

<script>
    // --- DATA ---
    // Expanded Database
    const phrases = [
        // 1. SURVIVAL
        { id: "s1", category: "survival", jp: "„Åô„Åø„Åæ„Åõ„Çì", romaji: "Su-mi-ma-sen", cn: "‰∏çÂ•ΩÊÑèÊÄù / Ë´ãÂïè", en: "Excuse me" },
        { id: "s2", category: "survival", jp: "„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô", romaji: "A-ri-ga-tou Go-zai-ma-su", cn: "Ë¨ùË¨ù", en: "Thank you" },
        { id: "s3", category: "survival", jp: "Â§ß‰∏àÂ§´„Åß„Åô", romaji: "Dai-jou-bu de-su", cn: "Ê≤íÈóú‰øÇ / ‰∏çÁî®‰∫Ü", en: "It's okay / No thanks" },
        { id: "s4", category: "survival", jp: "„ÅØ„ÅÑ / „ÅÑ„ÅÑ„Åà", romaji: "Hai / Ii-e", cn: "ÊòØ / ‰∏çÊòØ", en: "Yes / No" },
        { id: "s5", category: "survival", jp: "„Çè„Åã„Çä„Åæ„Åõ„Çì", romaji: "Wa-ka-ri-ma-sen", cn: "ÊàëËÅΩ‰∏çÊáÇ", en: "I don't understand" },
        { id: "s6", category: "survival", jp: "Ëã±Ë™û„É°„Éã„É•„Éº„ÅØ„ÅÇ„Çä„Åæ„Åô„ÅãÔºü", romaji: "Ei-go me-nyuu wa a-ri-ma-su ka?", cn: "ÊúâËã±ÊñáËèúÂñÆÂóéÔºü", en: "English menu?" },

        // 2. DINING
        { id: "d1", category: "dining", jp: "„Åì„Çå„ÄÅ„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô", romaji: "Ko-re, o-ne-gai shi-ma-su", cn: "ÊàëË¶ÅÈªûÈÄôÂÄã", en: "This one please" },
        { id: "d2", category: "dining", jp: "„ÅäÊ∞¥„Åè„Å†„Åï„ÅÑ", romaji: "O-mi-zu ku-da-sai", cn: "Ë´ãÁµ¶ÊàëÊ∞¥", en: "Water please" },
        { id: "d3", category: "dining", jp: "„Åä‰ºöË®à„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô", romaji: "O-kai-kei o-ne-gai shi-ma-su", cn: "È∫ªÁÖ©ÁµêÂ∏≥", en: "Check please" },
        { id: "d4", category: "dining", jp: "„ÉÜ„Ç§„ÇØ„Ç¢„Ç¶„Éà„Åß„Åç„Åæ„Åô„ÅãÔºü", romaji: "Tei-ku-au-to de-ki-ma-su ka?", cn: "ÂèØ‰ª•Â§ñÂ∏∂ÂóéÔºü", en: "Can I take out?" },
        { id: "d5", category: "dining", jp: "ÁæéÂë≥„Åó„ÅÑÔºÅ", romaji: "Oi-shii!", cn: "Â•ΩÂêÉÔºÅ", en: "Delicious!" },
        { id: "d6", category: "dining", jp: "Ë±öËÇâ„ÅØÂÖ•„Å£„Å¶„ÅÑ„Åæ„Åô„ÅãÔºü", romaji: "Bu-ta-ni-ku wa hait-te i-ma-su ka?", cn: "ÈÄôË£°Èù¢ÊúâË±¨ËÇâÂóéÔºü", en: "Does this contain pork?" }, // Ê≤ñÁπ©Â∏∏Ë¶ã

        // 3. KIDS (Parenting)
        { id: "k1", category: "kids", jp: "Â≠ê‰æõÁî®„ÅÆÊ§ÖÂ≠ê", romaji: "Ko-do-mo you-no i-su", cn: "ÂÖíÁ´•Ê§Ö", en: "High chair" },
        { id: "k2", category: "kids", jp: "Âèñ„ÇäÁöø„Å®„Çπ„Éó„Éº„É≥", romaji: "To-ri-za-ra to su-puu-n", cn: "ÂàÜÈ£üÁõ§ÂíåÊπØÂåô", en: "Small plate and spoon" },
        { id: "k3", category: "kids", jp: "„Éà„Ç§„É¨Ë°å„Åç„Åü„ÅÑÔºÅ", romaji: "To-i-re i-ki-tai!", cn: "ÊÉ≥‰∏äÂªÅÊâÄÔºÅ(Â∞èÂ≠©Ë™™)", en: "I want to go to toilet" },
        { id: "k4", category: "kids", jp: "„ÅäÊπØ„Çí„ÇÇ„Çâ„Åà„Åæ„Åô„ÅãÔºü", romaji: "O-yu o mo-ra-e-ma-su ka?", cn: "ÂèØ‰ª•Áµ¶ÊàëÁÜ±Ê∞¥ÂóéÔºü(Ê≥°Â•∂Áî®)", en: "Hot water please" },
        { id: "k5", category: "kids", jp: "„Åî„ÇÅ„Çì„Å™„Åï„ÅÑ„ÄÅ„Åì„Åº„Åó„Åæ„Åó„Åü", romaji: "Go-men-na-sai, ko-bo-shi-ma-shi-ta", cn: "Â∞ç‰∏çËµ∑ÔºåÊâìÁøªÊù±Ë•ø‰∫Ü", en: "Sorry, spilled it" },
        { id: "k6", category: "kids", jp: "„Åã„Çè„ÅÑ„ÅÑ„Åß„Åô„Å≠", romaji: "Ka-wai-i de-su ne", cn: "Â•ΩÂèØÊÑõÂñî (ËÅΩÂà∞Âà•‰∫∫Á®±ËÆöÊôÇ)", en: "So cute" },

        // 4. SHOPPING
        { id: "sh1", category: "shopping", jp: "„Åì„Çå„ÇíË¶ã„Åõ„Å¶„Åè„Å†„Åï„ÅÑ", romaji: "Ko-re o mi-se-te ku-da-sai", cn: "Ë´ãËÆìÊàëÁúãÈÄôÂÄã", en: "Show me this" },
        { id: "sh2", category: "shopping", jp: "„ÅÑ„Åè„Çâ„Åß„Åô„ÅãÔºü", romaji: "I-ku-ra de-su ka?", cn: "Â§öÂ∞ëÈå¢Ôºü", en: "How much?" },
        { id: "sh3", category: "shopping", jp: "„Ç´„Éº„Éâ„ÅØ‰Ωø„Åà„Åæ„Åô„ÅãÔºü", romaji: "Kaa-do wa tsu-ka-e-ma-su ka?", cn: "ÂèØ‰ª•Âà∑Âç°ÂóéÔºü", en: "Credit card OK?" },
        { id: "sh4", category: "shopping", jp: "Ë¢ã„ÅØ„ÅÑ„Çä„Åæ„Åõ„Çì", romaji: "Fu-ku-ro wa i-ri-ma-sen", cn: "‰∏çÁî®Ë¢ãÂ≠ê", en: "No bag needed" },
        { id: "sh5", category: "shopping", jp: "ÂÖçÁ®é„Åß„Åç„Åæ„Åô„ÅãÔºü", romaji: "Men-zei de-ki-ma-su ka?", cn: "ÂèØ‰ª•ÈÄÄÁ®ÖÂóéÔºü", en: "Tax free?" },

        // 5. DRIVING (Okinawa Crucial)
        { id: "dr1", category: "driving", jp: "Ê∫Ä„Çø„É≥„Å´„Åó„Å¶„Åè„Å†„Åï„ÅÑ", romaji: "Man-tan ni shi-te ku-da-sai", cn: "Ë´ãÂä†ÊªøÊ≤π", en: "Full tank please" },
        { id: "dr2", category: "driving", jp: "„É¨„ÇÆ„É•„É©„Éº", romaji: "Re-gyu-raa", cn: "Âä†ÊôÆÈÄöÊ±ΩÊ≤π (Á¥ÖËâ≤Ê≤πÊßç)", en: "Regular gas" },
        { id: "dr3", category: "driving", jp: "ÈßêËªäÂ†¥„ÅØ„Å©„Åì„Åß„Åô„ÅãÔºü", romaji: "Chuu-sha-jou wa do-ko...?", cn: "ÂÅúËªäÂ†¥Âú®Âì™Ôºü", en: "Where is parking?" },
        { id: "dr4", category: "driving", jp: "„Éû„ÉÉ„Éó„Ç≥„Éº„Éâ", romaji: "Map-pu Koo-do", cn: "Map Code (Â∞éËà™Áî®)", en: "Map Code" },

        // 6. HOTEL
        { id: "h1", category: "hotel", jp: "„ÉÅ„Çß„ÉÉ„ÇØ„Ç§„É≥„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô", romaji: "Chek-ku-in o-ne-gai...", cn: "ÊàëË¶ÅËæ¶ÁêÜÂÖ•‰Ωè", en: "Check in please" },
        { id: "h2", category: "hotel", jp: "Ëç∑Áâ©„ÇíÈ†ê„Åã„Å£„Å¶„ÇÇ„Çâ„Åà„Åæ„Åô„ÅãÔºü", romaji: "Ni-mo-tsu o a-zu-kat-te...", cn: "ÂèØ‰ª•ÂØÑÊîæË°åÊùéÂóéÔºü", en: "Keep luggage?" },
        { id: "h3", category: "hotel", jp: "Wi-Fi„ÅÆ„Éë„Çπ„ÉØ„Éº„Éâ„ÅØÔºü", romaji: "Wi-Fi no pa-su-waa-do wa?", cn: "Wi-Fi ÂØÜÁ¢ºÊòØÔºü", en: "Wi-Fi password?" },

        // 7. EMERGENCY
        { id: "e1", category: "emergency", jp: "Âä©„Åë„Å¶ÔºÅ", romaji: "Ta-su-ke-te!", cn: "ÊïëÂëΩ/Âπ´Âπ´ÊàëÔºÅ", en: "Help!" },
        { id: "e2", category: "emergency", jp: "Â≠ê‰æõ„ÅåÁÜ±„ÇíÂá∫„Åó„Åæ„Åó„Åü", romaji: "Ko-do-mo ga ne-tsu o da-shi-ma-shi-ta", cn: "Â∞èÂ≠©ÁôºÁáí‰∫Ü", en: "Child has fever" },
        { id: "e3", category: "emergency", jp: "„ÅäËÖπ„ÅåÁóõ„ÅÑ", romaji: "O-na-ka ga i-tai", cn: "ËÇöÂ≠êÁóõ", en: "Stomach hurts" },
        { id: "e4", category: "emergency", jp: "Ëñ¨Â±Ä", romaji: "Yak-kyo-ku", cn: "Ëó•Â±Ä", en: "Pharmacy" },
        { id: "e5", category: "emergency", jp: "ÁóÖÈô¢", romaji: "Byou-in", cn: "ÈÜ´Èô¢", en: "Hospital" }
    ];

    // --- CURRICULUM PLAN (16 Weeks) ---
    const curriculum = [
        { week: 1, title: "ÊöñË∫´ÈÄ±", desc: "ÊúÄÂü∫Êú¨ÁöÑÁ¶ÆË≤åÁî®Ë™û", lessons: ["s1", "s2", "s4"] },
        { week: 2, title: "Ëê¨ËÉΩË™ûÈÄ±", desc: "ÈÄôÂÖ©Âè•Ëµ∞ÈÅçÂ§©‰∏ã", lessons: ["s3", "s5"] },
        { week: 3, title: "ÈªûÈ§êÂü∫Á§é", desc: "ÁúãÂúñÈªûÈ§êÊ≥ï", lessons: ["d1", "d6", "d5"] },
        { week: 4, title: "È§êÂª≥ÊúçÂãô", desc: "ÁµêÂ∏≥ËàáÂñùÊ∞¥", lessons: ["d2", "d3", "d4"] },
        { week: 5, title: "Ë¶™Â≠êÈ§êÂª≥ÁØá (1)", desc: "ÈÄ≤È§êÂª≥ÂøÖÂïè", lessons: ["k1", "k2"] },
        { week: 6, title: "Ë¶™Â≠êÈ§êÂª≥ÁØá (2)", desc: "Á™ÅÁôºÁãÄÊ≥ÅËôïÁêÜ", lessons: ["k4", "k5"] },
        { week: 7, title: "Ë≥ºÁâ©ÊÆ∫Êâã", desc: "Ë©¢ÂïèÂÉπÈå¢", lessons: ["sh1", "sh2"] },
        { week: 8, title: "Ë≥ºÁâ©ÁµêÂ∏≥", desc: "Âà∑Âç°ËàáÈÄÄÁ®Ö", lessons: ["sh3", "sh4", "sh5"] },
        { week: 9, title: "Ëá™ÈßïÂä†Ê≤π", desc: "ÁßüËªäÂøÖÂÇô", lessons: ["dr1", "dr2"] },
        { week: 10, title: "ÊâæË∑ØÂÅúËªä", desc: "Â∞éËà™ËàáÂÅúËªä", lessons: ["dr3", "dr4"] },
        { week: 11, title: "È£ØÂ∫ó‰ΩèÂÆø", desc: "ÂÖ•‰ΩèËàáÁ∂≤Ë∑Ø", lessons: ["h1", "h3"] },
        { week: 12, title: "È£ØÂ∫óÊúçÂãô", desc: "ÂØÑÊîæË°åÊùé", lessons: ["h2", "s6"] },
        { week: 13, title: "ÁîüÁêÜÈúÄÊ±Ç", desc: "ÂªÅÊâÄÂæàÈáçË¶Å", lessons: ["k3"] }, // Reusing k3 for generic toilet
        { week: 14, title: "Á∑äÊÄ•ÈÜ´ÁôÇ (1)", desc: "Ë∫´È´î‰∏çÈÅ©", lessons: ["e2", "e3"] },
        { week: 15, title: "Á∑äÊÄ•ÈÜ´ÁôÇ (2)", desc: "ÊâæÂú∞ÊñπÊ±ÇÊïë", lessons: ["e1", "e4", "e5"] },
        { week: 16, title: "Á∏ΩË§áÁøí", desc: "Ê∫ñÂÇôÂá∫ÁôºÔºÅ", lessons: ["k6"] } // Fun review
    ];

    // --- LOGIC ---

    // 1. Initial Load
    document.addEventListener('DOMContentLoaded', () => {
        renderCurriculum();
        renderDict('all');
        updateProgress();
    });

    // 2. View Switching
    function switchView(viewName, navEl) {
        document.querySelectorAll('.view').forEach(el => el.classList.remove('active-view'));
        document.getElementById(`view-${viewName}`).classList.add('active-view');
        
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        navEl.classList.add('active');
    }

    // 3. Render Dictionary
    function renderDict(filter, tabEl = null) {
        if(tabEl) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            tabEl.classList.add('active');
        }

        const container = document.getElementById('dict-container');
        container.innerHTML = '';
        
        const filtered = filter === 'all' ? phrases : phrases.filter(p => p.category === filter);

        filtered.forEach(p => {
            const el = document.createElement('div');
            el.className = `card ${p.category === 'emergency' ? 'emergency' : ''}`;
            el.onclick = (e) => { speak(p.jp); };
            el.innerHTML = `
                <div class="card-header">
                    <div class="jp-text">${p.jp}</div>
                    <div style="opacity:0.6">üîä</div>
                </div>
                <span class="romaji">${p.romaji}</span>
                <div style="height:1px; background:rgba(255,255,255,0.1); margin:8px 0;"></div>
                <div class="cn-text">${p.cn}</div>
                <div class="en-text">${p.en}</div>
            `;
            container.appendChild(el);
        });
    }

    // 4. Render Curriculum
    function renderCurriculum() {
        const container = document.getElementById('curriculum-container');
        container.innerHTML = '';

        // Get saved progress
        const savedProgress = JSON.parse(localStorage.getItem('jp_progress') || '[]');

        curriculum.forEach(week => {
            const weekDiv = document.createElement('div');
            weekDiv.className = 'week-block';
            
            let lessonsHTML = '';
            week.lessons.forEach(lid => {
                const p = phrases.find(item => item.id === lid);
                const isChecked = savedProgress.includes(lid) ? 'checked' : '';
                
                if(p) {
                    lessonsHTML += `
                        <div class="lesson-item">
                            <div class="play-btn" onclick="speak('${p.jp}')">‚ñ∂</div>
                            <div class="lesson-content" onclick="speak('${p.jp}')">
                                <div class="lesson-jp">${p.jp}</div>
                                <div class="romaji" style="font-size:12px; margin-bottom:2px;">${p.romaji}</div>
                                <div class="lesson-cn">${p.cn}</div>
                            </div>
                            <div class="checkbox-wrapper ${isChecked}" onclick="toggleCheck('${lid}', this)">
                                <span class="check-icon">‚úî</span>
                            </div>
                        </div>
                    `;
                }
            });

            weekDiv.innerHTML = `
                <div class="week-title">
                    Week ${week.week} 
                    <span class="week-subtitle">${week.title} - ${week.desc}</span>
                </div>
                ${lessonsHTML}
            `;
            container.appendChild(weekDiv);
        });
    }

    // 5. Progress Logic (LocalStorage)
    function toggleCheck(id, el) {
        let progress = JSON.parse(localStorage.getItem('jp_progress') || '[]');
        
        if (progress.includes(id)) {
            progress = progress.filter(i => i !== id);
            el.classList.remove('checked');
        } else {
            progress.push(id);
            el.classList.add('checked');
            // Little feedback sound or vibration could go here
        }
        
        localStorage.setItem('jp_progress', JSON.stringify(progress));
        updateProgress();
    }

    function updateProgress() {
        const progress = JSON.parse(localStorage.getItem('jp_progress') || '[]');
        const totalLessons = curriculum.reduce((acc, curr) => acc + curr.lessons.length, 0);
        const completed = progress.length;
        const percentage = Math.round((completed / totalLessons) * 100);

        document.getElementById('progress-text').innerText = `${percentage}%`;
        document.getElementById('progress-fill').style.width = `${percentage}%`;
    }

    // 6. Speech
    function speak(text) {
        if ('speechSynthesis' in window) {
            window.speechSynthesis.cancel(); // Stop previous
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'ja-JP';
            u.rate = 0.85; // slightly slower
            window.speechSynthesis.speak(u);
            
            const t = document.getElementById('toast');
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 1500);
        }
    }

</script>

</body>
</html>
