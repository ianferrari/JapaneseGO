<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>JapaneseGO V4.0</title>
    <style>
        :root {
            --bg-color: #000000;
            --card-bg: #1c1c1e;
            --accent-color: #0A84FF;
            --text-primary: #FFFFFF;
            --text-secondary: #8E8E93;
            /* èª¿æ•´é…ç½® */
            --header-h: 80px; 
            --tabs-h: 60px;
        }

        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; }

        body {
            background-color: #000000;
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0; padding: 0;
            /* é ç•™é ‚éƒ¨ç©ºé–“ï¼Œç¢ºä¿å…§å®¹ä¸è¢«æ“‹ä½ */
            padding-top: calc(var(--header-h) + var(--tabs-h) + 20px);
            padding-bottom: 100px;
        }

        /* 1. æ¨™é¡Œåˆ— (åº•å±¤) */
        .top-header {
            position: fixed;
            top: 0; left: 0; right: 0;
            height: var(--header-h);
            background: rgba(0,0,0,0.95);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            z-index: 100; /* å±¤ç´š 100 */
            display: flex; align-items: flex-end; padding: 0 20px 15px 20px;
        }
        .top-header h1 { margin: 0; font-size: 26px; font-weight: 800; background: linear-gradient(90deg, #fff, #999); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        /* 2. æŒ‰éˆ•åˆ— (æœ€ä¸Šå±¤ - å¤ªä¸Šçš‡å±¤ç´š) */
        .sticky-tabs-bar {
            position: fixed;
            top: var(--header-h); /* æ¥åœ¨æ¨™é¡Œä¸‹æ–¹ */
            left: 0; right: 0;
            height: var(--tabs-h);
            background: #111; /* æ·±è‰²èƒŒæ™¯ï¼Œé¿å…é€è¦–å¹²æ“¾ */
            z-index: 9999; /* å±¤ç´šæœ€é«˜ï¼Œä¿è­‰å¯é»æ“Š */
            display: flex; align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }

        .tabs-scroller {
            width: 100%;
            overflow-x: auto;
            display: flex;
            gap: 12px;
            padding: 0 15px;
            align-items: center;
            height: 100%;
        }
        
        .tab-btn {
            background: #333;
            color: #ccc;
            border: 1px solid #555;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 15px;
            font-weight: 600;
            white-space: nowrap;
            flex-shrink: 0;
            cursor: pointer;
        }
        .tab-btn.active {
            background: var(--accent-color);
            color: #fff;
            border-color: var(--accent-color);
            box-shadow: 0 0 10px rgba(10,132,255,0.5);
        }

        /* å…§å®¹å€ */
        .view { display: none; padding: 0 20px; max-width: 600px; margin: 0 auto; }
        .view.active { display: block; }

        /* å¡ç‰‡æ¨£å¼ */
        .card {
            background: var(--card-bg);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 18px;
            margin-bottom: 15px;
            position: relative;
        }
        .card:active { background: #2a2a2a; transform: scale(0.98); transition: 0.1s; }
        .jp { font-size: 20px; font-weight: 700; margin-bottom: 4px; }
        .romaji { color: #FFD60A; font-family: monospace; font-size: 14px; margin-bottom: 8px; display: block; }
        .cn { font-size: 16px; color: #ddd; }
        
        /* åº•éƒ¨å°èˆª */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; right: 0;
            height: 80px; background: rgba(20,20,20,0.98);
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex; justify-content: space-around; padding-top: 10px;
            z-index: 500;
        }
        .nav-item { color: #666; font-size: 11px; text-align: center; width: 50%; }
        .nav-item.active { color: var(--accent-color); }
        .nav-icon { font-size: 24px; margin-bottom: 4px; display: block; }

        /* å­¸ç¿’é€²åº¦æ¢ */
        .week-block { margin-bottom: 25px; }
        .lesson-row { display: flex; align-items: center; background: #222; padding: 12px; border-radius: 12px; margin-bottom: 8px; border: 1px solid #333; }
        .check-circle { width: 24px; height: 24px; border: 2px solid #555; border-radius: 50%; margin-left: auto; display: flex; align-items: center; justify-content: center; }
        .check-circle.checked { background: #30D158; border-color: #30D158; }

    </style>
</head>
<body>

<div class="top-header">
    <div>
        <h1>JapaneseGO</h1>
        <div style="font-size: 12px; color: #888;">æ²–ç¹©ç‰¹è¨“ V4.0 (çµ•å°ä¿®å¾©ç‰ˆ)</div>
    </div>
</div>

<div id="tabs-bar" class="sticky-tabs-bar" style="display: none;">
    <div class="tabs-scroller">
        <button class="tab-btn active" onclick="filterDict('all', this)">å…¨éƒ¨</button>
        <button class="tab-btn" onclick="filterDict('survival', this)">ç”Ÿå­˜</button>
        <button class="tab-btn" onclick="filterDict('dining', this)">ç¾é£Ÿ</button>
        <button class="tab-btn" onclick="filterDict('shopping', this)">è³¼ç‰©</button>
        <button class="tab-btn" onclick="filterDict('kids', this)">è¦ªå­</button>
        <button class="tab-btn" onclick="filterDict('driving', this)">è‡ªé§•</button>
        <button class="tab-btn" onclick="filterDict('hotel', this)">ä½å®¿</button>
        <button class="tab-btn" onclick="filterDict('emergency', this)">ç·Šæ€¥</button>
    </div>
</div>

<div id="view-learn" class="view active">
    <div style="background:#222; padding:15px; border-radius:15px; margin-bottom:20px; border:1px solid #444;">
        <div style="display:flex; justify-content:space-between; margin-bottom:5px; color:#aaa; font-size:14px;">
            <span>ç¸½é€²åº¦</span>
            <span id="progress-text">0%</span>
        </div>
        <div style="height:6px; background:#444; border-radius:3px;">
            <div id="progress-fill" style="height:100%; background:#30D158; width:0%; transition:0.3s;"></div>
        </div>
    </div>
    <div id="curriculum-container"></div>
</div>

<div id="view-dict" class="view">
    <div id="dict-container"></div>
</div>

<div class="bottom-nav">
    <div class="nav-item active" onclick="switchView('learn', this)">
        <span class="nav-icon">ğŸ“…</span>
        ç‰¹è¨“è¨ˆç•«
    </div>
    <div class="nav-item" onclick="switchView('dict', this)">
        <span class="nav-icon">ğŸ“–</span>
        å¯¦ç”¨å­—å…¸
    </div>
</div>

<script>
    // --- è³‡æ–™åº« (60+å¥) ---
    const phrases = [
        { id: "s1", cat: "survival", jp: "ã™ã¿ã¾ã›ã‚“", romaji: "Su-mi-ma-sen", cn: "ä¸å¥½æ„æ€" },
        { id: "s2", cat: "survival", jp: "ã‚ã‚ŠãŒã¨ã†", romaji: "A-ri-ga-tou", cn: "è¬è¬" },
        { id: "s3", cat: "survival", jp: "å¤§ä¸ˆå¤«", romaji: "Dai-jou-bu", cn: "æ²’é—œä¿‚" },
        { id: "s4", cat: "survival", jp: "ãƒˆã‚¤ãƒ¬", romaji: "To-i-re", cn: "å»æ‰€" },
        { id: "d1", cat: "dining", jp: "ã“ã‚Œãã ã•ã„", romaji: "Ko-re Ku-da-sai", cn: "è«‹çµ¦æˆ‘é€™å€‹" },
        { id: "d2", cat: "dining", jp: "ãŠæ°´", romaji: "O-mi-zu", cn: "æ°´" },
        { id: "d3", cat: "dining", jp: "ãŠä¼šè¨ˆ", romaji: "O-kai-kei", cn: "çµå¸³" },
        { id: "d4", cat: "dining", jp: "ç¾å‘³ã—ã„", romaji: "Oi-shii", cn: "å¥½åƒ" },
        { id: "sh1", cat: "shopping", jp: "ã„ãã‚‰ï¼Ÿ", romaji: "I-ku-ra?", cn: "å¤šå°‘éŒ¢ï¼Ÿ" },
        { id: "sh2", cat: "shopping", jp: "ã‚«ãƒ¼ãƒ‰OKï¼Ÿ", romaji: "Kaa-do OK?", cn: "å¯ä»¥åˆ·å¡å—ï¼Ÿ" },
        { id: "sh3", cat: "shopping", jp: "å…ç¨", romaji: "Men-zei", cn: "é€€ç¨…" },
        { id: "k1", cat: "kids", jp: "å­ä¾›ã®æ¤…å­", romaji: "Ko-do-mo Isu", cn: "å…’ç«¥æ¤…" },
        { id: "k2", cat: "kids", jp: "ã‚¹ãƒ—ãƒ¼ãƒ³", romaji: "Su-puu-n", cn: "æ¹¯åŒ™" },
        { id: "k3", cat: "kids", jp: "ãŠæ¹¯", romaji: "O-yu", cn: "ç†±æ°´" },
        { id: "dr1", cat: "driving", jp: "æº€ã‚¿ãƒ³", romaji: "Man-tan", cn: "åŠ æ»¿æ²¹" },
        { id: "dr2", cat: "driving", jp: "é§è»Šå ´", romaji: "Chuu-sha-jou", cn: "åœè»Šå ´" },
        { id: "h1", cat: "hotel", jp: "ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³", romaji: "Chek-ku-in", cn: "Check-in" },
        { id: "h2", cat: "hotel", jp: "è·ç‰©", romaji: "Ni-mo-tsu", cn: "è¡Œæ" },
        { id: "e1", cat: "emergency", jp: "åŠ©ã‘ã¦", romaji: "Ta-su-ke-te", cn: "æ•‘å‘½" },
        { id: "e2", cat: "emergency", jp: "è–¬å±€", romaji: "Yak-kyo-ku", cn: "è—¥å±€" },
        { id: "e3", cat: "emergency", jp: "ç—…é™¢", romaji: "Byou-in", cn: "é†«é™¢" }
    ];

    const weeks = [
        { t: "Week 1 æš–èº«", ids: ["s1","s2","s3"] },
        { t: "Week 2 é»é¤", ids: ["d1","d2","d3"] },
        { t: "Week 3 è³¼ç‰©", ids: ["sh1","sh2"] },
        { t: "Week 4 è¦ªå­", ids: ["k1","k2","k3"] },
        { t: "Week 5 è‡ªé§•", ids: ["dr1","dr2"] },
        { t: "Week 6 ä½å®¿", ids: ["h1","h2"] },
        { t: "Week 7 ç·Šæ€¥", ids: ["e1","e2","e3"] }
    ];

    // åˆå§‹åŒ–
    renderDict('all');
    renderPlan();
    
    function switchView(view, btn) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById('view-'+view).classList.add('active');
        btn.classList.add('active');
        
        // åˆ‡æ›æŒ‰éˆ•åˆ—é¡¯ç¤º
        document.getElementById('tabs-bar').style.display = (view === 'dict') ? 'flex' : 'none';
        window.scrollTo(0,0);
    }

    function renderDict(cat, btn) {
        if(btn) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }
        const box = document.getElementById('dict-container');
        box.innerHTML = '';
        const data = (cat==='all') ? phrases : phrases.filter(p=>p.cat===cat);
        
        data.forEach(p => {
            box.innerHTML += `
                <div class="card" onclick="speak('${p.jp}')">
                    <div class="jp">${p.jp} <span style="font-size:16px">ğŸ”Š</span></div>
                    <span class="romaji">${p.romaji}</span>
                    <div class="cn">${p.cn}</div>
                </div>`;
        });
    }

    function renderPlan() {
        const box = document.getElementById('curriculum-container');
        let saved = JSON.parse(localStorage.getItem('jp_v4_prog')||'[]');
        
        weeks.forEach((w, i) => {
            let html = `<div class="week-block"><h3 style="color:#0A84FF; margin-bottom:10px;">${w.t}</h3>`;
            w.ids.forEach(id => {
                let p = phrases.find(x=>x.id===id);
                let check = saved.includes(id) ? 'checked' : '';
                html += `
                    <div class="lesson-row">
                        <div onclick="speak('${p.jp}')" style="flex:1">
                            <div style="font-weight:bold; font-size:16px;">${p.jp} ğŸ”Š</div>
                            <div style="color:#888; font-size:13px;">${p.cn}</div>
                        </div>
                        <div class="check-circle ${check}" onclick="toggle('${id}', this)">âœ“</div>
                    </div>`;
            });
            box.innerHTML += html + `</div>`;
        });
        updateBar();
    }

    function toggle(id, el) {
        let saved = JSON.parse(localStorage.getItem('jp_v4_prog')||'[]');
        if(saved.includes(id)) {
            saved = saved.filter(x=>x!==id);
            el.classList.remove('checked');
        } else {
            saved.push(id);
            el.classList.add('checked');
        }
        localStorage.setItem('jp_v4_prog', JSON.stringify(saved));
        updateBar();
    }

    function updateBar() {
        let saved = JSON.parse(localStorage.getItem('jp_v4_prog')||'[]');
        let total = weeks.reduce((a,b)=>a+b.ids.length,0);
        let pct = Math.round(saved.length/total*100);
        document.getElementById('progress-fill').style.width = pct+'%';
        document.getElementById('progress-text').innerText = pct+'%';
    }

    function speak(txt) {
        let u = new SpeechSynthesisUtterance(txt);
        u.lang = 'ja-JP';
        window.speechSynthesis.speak(u);
    }
</script>
</body>
</html>
